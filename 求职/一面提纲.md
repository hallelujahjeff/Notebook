[TOC]
# CPP
***

### 面向对象三大特征：**封装，继承，多态**
1. 简述一下C++中三大特征的体现：
> ...

2. 讲讲C++中多态如何实现？ 讲个游戏开发中使用多态的例子
> 静态多态：函数重载、模板实现
动态多态： 函数重写

3. 虚函数与虚表指针: C++如何知道，我调用一个基类对象身上的方法时，应该执行哪个子类对象身上的函数？
> 每个类会维护一张虚函数表，这个虚函数表会在编译期间被构建出来，存放在常量存储区。
在创建虚函数表时，如果派生类重写了基类的方法，那么派生类虚函数表将保留重写后的虚函数地址；如果有一个虚函数派生类没有重写，则虚函数表中保留的是基类虚函数的地址。
编译期间，编译器将函数调用转化为访问虚表指针，虚表指针指向的内容就是虚函数的地址。

4. 简单介绍一下C++模板，可以将模板声明现在头文件中，模板定义写在C++中吗？
> 不行，模板在编译器编译期间展开，模板定义写在C++中，编辑阶段无法展开。

5. C++模板和函数重写都是实现多态的方式，两者有什么明显的区别，优缺点？
> 模板是静态多态，其多态由编译器在编译阶段对模板展开实现； 函数重写使用虚函数表和虚表指针，在运行期推断实现； 
两者有性能区别

### C++语法
1. 讲讲const int* a和 int* const a的区别
> 写在后面表示指针本身不可指向其他内存


### C++内存分配
1. 讲讲堆和栈的区别？
> - 管理方式不同：栈由编译器自动管理，堆的分配与释放工作由程序员控制。
> - 碎片问题：对于堆来说，频繁的new/delete操作会产生大量磁盘碎片，而栈是先进后出的数据结构，不会有碎片产生
> - 空间大小：栈默认1~2m，而32位系统下堆内存可达到4G左右
> - 访问效率：有专门的寄存器存放堆的地址，压栈出栈有专门的指令执行，效率很高。堆的分配由库函数提供，效率较低还会产生碎片。

2. C++ 如何在堆上申请一块内存？(malloc、 new) 讲一个malloc和new的区别
> - 返回类型的安全性
    new返回的是对象类型的指针，无需进行类型转换。故new是符合类型安全性的运算符。
    malloc返回void *,需要通过强制转换成我们需要的类型
> - new在分配内存之后会构造对象，调用对象的构造函数；使用delete之后也会调用对象的析构函数。
malloc仅仅是开辟了一块内存。


### C++智能指针
1. 讲一讲C++11有哪些智能指针？(shared_ptr, unique_ptr, weak_ptr)

2. 简述一下shared_ptr是怎么实现的
> 普通指针+引用计数； 指向同一对象的所有智能指针共用一个引用计数；

3. 什么时候用shared_ptr， 什么时候用weak_ptr
> 可以用weak_ptr解决循环引用问题； 另外对一些资源弱依赖时，可以用weak_ptr，防止内存没办法及时回收

4. 讲一讲垃圾回收算法，UE4用的什么方式？
> 引用计数、标记清除
UE的实现方式：
启动垃圾回收，加锁（ 保持所有对象的引用关系不变 ）
设置所有对象为”不可达”标记（根对象、特殊对象 除外）
遍历根对象列表，根对象引用到的对象去除”不可达”标记
收集所有仍然标记为”不可达”的对象，全部删除

5. UE4怎么维护对象之间的引用关系？如何保证一个UObject在需要的时候，不被引擎GC？
> 使用UPROPERTY()宏告诉UE4对象引用关系，UObject需要处于引用链上，或者通过AddToRoot变为根对象

6. GC是一个比较耗时的操作，有哪些优化方式？
> 1. 打开簇，将Character，Weapon等生命周期一致的 Actor 对象勾选 Cluster
2. 最好的优化还是减少UObject对象数量（包括：少用蓝图宏，Level内的Actor数量控制）
3. 优化GC调用时机，原则上能不调用就不调用，可在关键点调用
4. 采用对象池，不要频繁清理和生成大的对象

### C++11
1. 用过哪些C++11的特性？

2. 简单介绍一下右值引用。左值和右值的区别是什么。
> **左值**： 可以取地址的，有名字，非临时的就是左值。
**右值**： 不能取地址，没有名字，临时的就是右值。

3. 移动构造函数和拷贝构造函数的区别是什么？
> 拷贝构造函数触发一次对象拷贝，移动构造函数直接接管临时对象的那一块内存，性能更好。


### 数据结构
1. 用过STL吗，讲几个用过的STL数据结构

2. std::vector内部是什么？（数组结构） ， vector中的数据内存是如何分配的？ 扩容因子如何选取？
> 若扩容因子过大，会造成空间浪费；若扩容因子过小，会导致扩容次数变多，性能下降

3. 讲讲遍历vector的方法（数组for循环，迭代器）。 如何批量删除一个vector中符合条件的元素？ 
> for循环需要倒着遍历删除
使用迭代器遍历删除的话，需要it = vec.erase(it)来删除，要注意erase后it迭代器会失效

4. 如果我在使用迭代器遍历vector的同时，使用push_back往数组中增添元素，这个操作会有危险吗？ 讲讲vector内存扩容
> 有可能，触发内存扩容导致迭代器失效

5. 用过map吗，讲讲std:map内部实现
> map底层是红黑树，一种平衡二叉树，特点是树的最长路径不超过最短路径的两倍。
增加查找删除都是logn的复杂度

6. map和unordered_map的区别，如何判断该使用哪一种？

7. 如何解决哈希表冲突问题
> 再散列、链地址

8. 了解最短路径算法吗，为什么游戏开发常常选择A*算法？（A*算法的优势）
> 使用了先验知识，往往能更快找到最短路径； 缺点是若估价函数选取不对，可能消耗更大。

9. 玩过mc吗，如何实现mc中水向四周泛滥的效果


### 图形学
1. 简单介绍一下图形学管线，光栅化是怎么做的？

2. phong着色法

3. 显卡绘制画面的速度大大高于显示器绘制速度，导致画面撕裂，如何解决这个问题？
> 双缓冲

4. 讲一讲法线贴图，为什么法线贴图看起来往往是蓝色的？ 
> 法线存储在切线空间

### UE

- Actor和UObject的关系是什么，Actor相比UObject多了哪些特性？ 所有Actor都能放入场景吗？
> Actor有生命周期，UE做了整套网络同步，支持添加ActorComponent；
> 只有包含SceneComponent的Actor能放入场景

- 了解哪些UFUNCTION函数标记？

- UHT是什么，UBT是什么？ 


